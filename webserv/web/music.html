<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webserv | Listen Music</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Fira+Code&display=swap"
        rel="stylesheet">

    <style>
        /* UI UNCHANGED */
        .player-card {
            background: linear-gradient(180deg, rgba(22, 27, 46, 0.9), rgba(10, 14, 23, 0.95));
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 2rem;
            backdrop-filter: blur(10px);
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        .album-art { width: 250px; height: 250px; margin: 0 auto 2rem; }
        .visualizer { display: flex; align-items: center; justify-content: center; gap: 4px; height: 100%; }
        .bar { width: 8px; background: #fff; border-radius: 4px; animation: bounce 1s infinite ease-in-out; }
        @keyframes bounce {
            0%,100% { height: 20%; opacity: .5; }
            50% { height: 60%; opacity: 1; }
        }
        .controls { display: flex; justify-content: center; gap: 2rem; margin-top: 2rem; }
        .control-btn { background: transparent; border: none; color: #fff; cursor: pointer; }
        .btn-play { width: 60px; height: 60px; background: var(--gradient-main); border-radius: 50%; }
        .progress-bar { width: 100%; height: 6px; background: rgba(255,255,255,.1); margin-top: 2rem; position: relative; }
        .progress-fill { height: 100%; width: 0%; background: var(--accent-primary); }
        .playlist { margin-top: 4rem; }
        .track-item { display: flex; padding: 1rem; border-bottom: 1px solid var(--border-color); cursor: pointer; }
    </style>
</head>

<body>

<header>
    <div class="container">
        <div class="logo">WEB<span>SERV</span></div>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/video.html">Video</a></li>
                <li><a href="/music.html" class="active">Music</a></li>
                <li><a href="/test.html">Test Dashboard</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
        </nav>
    </div>
</header>

<main class="container">

<div class="grid grid-2">
    <div>
        <div class="player-card">
            <div class="album-art">
                <div class="visualizer">
                    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                </div>
            </div>

            <h2 id="song-title">Midnight Coding</h2>
            <p id="song-artist" style="color: var(--text-secondary);">Lo-Fi Beats</p>

            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>

            <div class="controls">
                <button class="control-btn" id="prev">‚èÆ</button>
                <button class="control-btn btn-play" id="play">‚ñ∂</button>
                <button class="control-btn" id="next">‚è≠</button>
            </div>
        </div>
    </div>

    <div class="playlist">
        <h3>Current Playlist</h3>
        <div class="card">
            <div class="track-item" onclick="playTrack(0)">Just Piano</div>
            <div class="track-item" onclick="playTrack(1)">Lyrics</div>
            <!-- <div class="track-item" onclick="playTrack(2)">Server Logic</div>
            <div class="track-item" onclick="playTrack(3)">Binary Flow</div> -->
        </div>
    </div>
</div>

</main>

<footer>
    <div class="container">
        <p>&copy; 2023 Webserv Project. Built with C++98.</p>
    </div>
</footer>

<!-- üîä AUDIO (HIDDEN) -->
<audio id="audio"></audio>

<!-- üéµ LOGIC ONLY -->
<script>
const tracks = [
    { title: "Just Piano", artist: "Retro Wave", src: "./assets/audio/Just_Piano.mp3" },
    { title: "Lyrics", artist: "Lo-Fi Beats", src: "./assets/audio/Lyrics.mp3" }
    // { title: "Server Logic", artist: "Deep House", src: "/music/server.mp3" },
    // { title: "Binary Flow", artist: "Techno", src: "/music/binary.mp3" }
];

let index = 1;
const audio = document.getElementById("audio");
const playBtn = document.getElementById("play");
const progress = document.querySelector(".progress-fill");
const title = document.getElementById("song-title");
const artist = document.getElementById("song-artist");

function loadTrack(i) {
    index = i;
    audio.src = tracks[i].src;
    title.textContent = tracks[i].title;
    artist.textContent = tracks[i].artist;
    audio.play();
    playBtn.textContent = "‚è∏";
}

function playTrack(i) { loadTrack(i); }

playBtn.onclick = () => {
    if (audio.paused) { audio.play(); playBtn.textContent = "‚è∏"; }
    else { audio.pause(); playBtn.textContent = "‚ñ∂"; }
};

document.getElementById("prev").onclick = () => loadTrack((index - 1 + tracks.length) % tracks.length);
document.getElementById("next").onclick = () => loadTrack((index + 1) % tracks.length);

audio.ontimeupdate = () => {
    progress.style.width = (audio.currentTime / audio.duration * 100) + "%";
};

loadTrack(index);
/* here handl seeking the time or (Jumping) */
const progressBar = document.querySelector(".progress-bar");

progressBar.addEventListener("click", (e) => {
    const rect = progressBar.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const width = rect.width;
    const percent = clickX / width;

    if (!isNaN(audio.duration)) {
        audio.currentTime = percent * audio.duration;
    }
});
/* this for drag seeking */
let isDragging = false;

progressBar.addEventListener("mousedown", () => isDragging = true);
document.addEventListener("mouseup", () => isDragging = false);

progressBar.addEventListener("mousemove", (e) => {
    if (!isDragging) return;

    const rect = progressBar.getBoundingClientRect();
    const x = Math.min(Math.max(e.clientX - rect.left, 0), rect.width);
    audio.currentTime = (x / rect.width) * audio.duration;
});

</script>

</body>
</html>
