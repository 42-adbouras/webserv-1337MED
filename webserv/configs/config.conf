server {
	listen 0.0.0.0:420;
	listen 0.0.0.0:2020;
	listen 8080;
	server_name www.example.local;

	root www;						# document root
	index index.html about.htm;		# default index files
	autoindex false;				# disable directory listing
	client_max_body_size 2M;		# body size limit

	# Map multiple error codes to pages
	error_page 404 /errors/404.html;
	error_page 500 /errors/500.html;

	# Server-wide CGI (extension -> interpreter)
	cgi .php /usr/bin/php-cgi;

	# Default location (static files under root)
	location / {
		allowed_methods GET;
	}

	# Enable autoindex for assets directory
	location /assets/ {
		autoindex on;
	}

	# File uploads (POST body stored here)
	location /upload {
		allowed_methods POST;
		upload_store www/uploads;
	}

	# Allow DELETE on uploaded files
	location /uploads/ {
		allowed_methods GET DELETE;
	}

	# Simple redirect
	location /old {
		redirect 301 /new;
	}

	# Per-location CGI (Python scripts)
	location /cgi/ {
		cgi .py /usr/bin/python3;
	}
}

server {
	listen 0.0.0.0;
	port 4242
	server_name admin.local;

	root www/admin;
	index index.html;
	autoindex off;
	client_max_body_size 512k;

	location / {
		allowed_methods GET;
	}
}
